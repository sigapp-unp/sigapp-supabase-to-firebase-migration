# ==================== FIREBASE ====================
# Path to the Firebase Admin SDK service account JSON file
# Download from: Firebase Console -> Project settings -> Service accounts
FIREBASE_SERVICE_ACCOUNT_PATH=./sigapp-dev-firebase-adminsdk.json

# ==================== SUPABASE ====================
# Supabase project URL (from Supabase dashboard -> Settings -> API)
SUPABASE_URL=https://your-project-id.supabase.co

# Supabase service_role key with read permissions (keep secret)
SUPABASE_SERVICE_ROLE_KEY=sbk_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# ==================== MIGRATION ====================
# Only migrate rows updated since this ISO 8601 timestamp (optional)
# Useful for incremental runs or limiting scope during testing
MIGRATE_SINCE=2025-01-01T00:00:00Z

# Number of records read per page (balance memory and speed)
PAGE_SIZE=500

# Number of concurrent write workers (adjust for Firestore limits)
CONCURRENCY=20

# Firestore structure mode: 'embedded' (recommended) or 'subcollections'
STRUCTURE_MODE=embedded

# Dry run (true = read only, no writes to Firestore)
DRY_RUN=false

# ==================== DEBUG / TESTING (OPTIONAL) ====================
# Limit number of records processed for quick tests
# DEBUG_LIMIT=100

# Custom paths for control/log files
# CHECKPOINT_PATH=./checkpoint.json
# FAILED_PATH=./failed.jsonl

# -------------------- Notes for developers --------------------
# - This repo is designed to run with Bun (bun main.ts). See README.md for full
#   run instructions and troubleshooting commands.
# - Never commit your service account JSON or this .env file to git. They are
#   intentionally added to .gitignore in this project.
# - The migration creates the following control files at runtime (also .gitignored):
#     * checkpoint.json    -> current progress (pageIndex, from, to, ts)
#     * failed.jsonl       -> lines of failed items with error details
#     * issues.jsonl       -> non-fatal data issues (e.g. categories without grades)
#   Keep these files to resume or audit the migration. They are safe to delete to
#   restart from scratch but are useful for incremental runs.
# - When testing locally, set DRY_RUN=true to verify behavior without writing to Firestore.
# - For production runs, ensure the service account has sufficient IAM permissions.
